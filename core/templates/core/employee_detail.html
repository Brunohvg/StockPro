{% extends 'base.html' %}

{% block content %}
<div class="space-y-8">

    <!-- Header -->
    <div class="flex flex-col lg:flex-row lg:items-center justify-between gap-6 pb-6 border-b border-slate-100">
        <div class="flex items-center gap-6">
            <div class="w-20 h-20 rounded-[2rem] bg-indigo-600 flex items-center justify-center text-white text-2xl font-black shadow-xl shadow-indigo-600/20">
                {{ employee.username|slice:":2"|upper }}
            </div>
            <div>
                <h1 class="text-3xl font-extrabold text-slate-900 tracking-tight">{{ employee.get_full_name|default:employee.username }}</h1>
                <p class="text-slate-500 font-medium">Histórico Individual de Auditoria e Operações.</p>
            </div>
        </div>
        <div class="flex items-center gap-3">
            <span class="px-4 py-2 bg-slate-100 text-slate-600 rounded-xl text-xs font-black uppercase tracking-widest border border-slate-200">
                ID Operador: #{{ employee.id }}
            </span>
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">

        <!-- Sidebar Info -->
        <div class="lg:col-span-1 space-y-6">
            <div class="bg-white rounded-[2rem] border border-slate-100 p-8 shadow-sm space-y-6">
                <div class="space-y-1">
                    <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Status da Conta</span>
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 rounded-full bg-emerald-500"></div>
                        <span class="text-sm font-bold text-slate-900">Ativo no Sistema</span>
                    </div>
                </div>

                <div class="space-y-1">
                    <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Nível de Acesso</span>
                    <div>
                        {% if employee.is_superuser %}
                            <span class="inline-flex px-3 py-1 bg-purple-50 text-purple-700 text-[10px] font-black uppercase tracking-tighter border border-purple-100 rounded-full">Super Administrador</span>
                        {% elif employee.is_staff %}
                            <span class="inline-flex px-3 py-1 bg-indigo-50 text-indigo-700 text-[10px] font-black uppercase tracking-tighter border border-indigo-100 rounded-full">Operador Senior (Staff)</span>
                        {% else %}
                            <span class="inline-flex px-3 py-1 bg-slate-50 text-slate-500 text-[10px] font-black uppercase tracking-tighter border border-slate-200 rounded-full">Operador Padrão</span>
                        {% endif %}
                    </div>
                </div>

                <div class="space-y-1">
                    <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest">E-mail Corporativo</span>
                    <p class="text-sm font-bold text-slate-900">{{ employee.email|default:"não informado" }}</p>
                </div>

                <div class="pt-6 border-t border-slate-50">
                    <p class="text-[10px] text-slate-400 font-medium">Membro desde: {{ employee.date_joined|date:"d/m/Y" }}</p>
                </div>
            </div>
        </div>

        <!-- Main Audit Feed -->
        <div class="lg:col-span-3">
            <div class="bg-white rounded-[2rem] border border-slate-100 shadow-sm overflow-hidden">
                <div class="p-8 border-b border-slate-50 flex items-center justify-between">
                    <h3 class="font-extrabold text-slate-900">Registro de Atividades Recentes</h3>
                    <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest">{{ movements|length }} registros encontrados</span>
                </div>

                <table class="w-full text-left border-collapse">
                    <thead class="bg-slate-50 border-b border-slate-100">
                        <tr>
                            <th class="px-8 py-5 text-[10px] font-black text-slate-400 uppercase tracking-widest">Data/Hora</th>
                            <th class="px-8 py-5 text-[10px] font-black text-slate-400 uppercase tracking-widest">Operação</th>
                            <th class="px-8 py-5 text-[10px] font-black text-slate-400 uppercase tracking-widest">Item</th>
                            <th class="px-8 py-5 text-right text-[10px] font-black text-slate-400 uppercase tracking-widest">Quantidade</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-slate-50">
                        {% for mov in movements %}
                        <tr class="group hover:bg-slate-50/50 transition-all">
                            <td class="px-8 py-6 whitespace-nowrap">
                                <span class="text-xs font-bold text-slate-600 font-mono">{{ mov.created_at|date:"d/m H:i" }}</span>
                            </td>
                            <td class="px-8 py-6 whitespace-nowrap">
                                <span class="inline-flex items-center px-2.5 py-1 rounded-lg text-[10px] font-black uppercase tracking-tighter
                                    {% if mov.type == 'IN' %}bg-emerald-50 text-emerald-700
                                    {% elif mov.type == 'OUT' %}bg-rose-50 text-rose-700
                                    {% else %}bg-amber-50 text-amber-700{% endif %}">
                                    {{ mov.get_type_display }}
                                </span>
                            </td>
                            <td class="px-8 py-6">
                                <div class="text-sm font-bold text-slate-900">{{ mov.product.name }}</div>
                                <div class="text-[10px] font-mono text-slate-400 uppercase">{{ mov.product.sku }}</div>
                            </td>
                            <td class="px-8 py-6 text-right">
                                <span class="text-sm font-black {% if mov.type == 'OUT' %}text-rose-600{% else %}text-emerald-600{% endif %}">
                                    {% if mov.type == 'OUT' %}-{% else %}+{% endif %}{{ mov.quantity }}
                                </span>
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="4" class="px-8 py-20 text-center">
                                <i data-lucide="monitor-off" class="w-12 h-12 text-slate-100 mx-auto mb-4"></i>
                                <p class="text-slate-400 font-bold uppercase text-[10px] tracking-widest">Nenhuma atividade registrada por este usuário</p>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

    </div>
</div>
{% endblock %}
